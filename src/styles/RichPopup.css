:root {
    /* Light Theme (Default) */
    --bg-popup: #ffffff;
    --bg-popup-section: #f8fafc;
    --bg-hover: #f0f4f8;
    --bg-active: #e8f0fe;

    --text-primary: #1a1f36;
    --text-secondary: #4a5568;
    --text-tertiary: #718096;
    --text-muted: #a0aec0;

    --border-light: #e2e8f0;
    --border-medium: #cbd5e1;

    --accent-blue: #2563eb;
    --accent-blue-light: #dbeafe;
    --accent-teal: #0d9488;
    --accent-purple: #7c3aed;
    --accent-red: #dc2626;
    --accent-orange: #ea580c;
    --accent-green: #16a34a;

    --shadow-popup: 0 12px 48px rgba(0, 0, 0, 0.2);

    /* Chemistry Colors */
    --atom-c: #404040;
    --atom-h: #808080;
    --atom-n: #3b82f6;
    --atom-o: #ef4444;
    --atom-s: #eab308;
    --atom-p: #f97316;
    --atom-f: #22c55e;
    --atom-cl: #22c55e;
    --atom-br: #a855f7;
    --atom-i: #6b21a8;

    --font-sans: 'IBM Plex Sans', -apple-system, sans-serif;
    --font-mono: 'IBM Plex Mono', monospace;
}

/* Dark Theme */
[data-theme="dark"] {
    --bg-popup: #1e222d;
    --bg-popup-section: #252a36;
    --bg-hover: #252a36;
    --bg-active: #2d3548;

    --text-primary: #f1f5f9;
    --text-secondary: #94a3b8;
    --text-tertiary: #64748b;
    --text-muted: #475569;

    --border-light: #2d3548;
    --border-medium: #3d4659;

    --shadow-popup: 0 12px 48px rgba(0, 0, 0, 0.5);
}

/* ===== TOOL POPUPS - Comprehensive Chemistry Tools ===== */
.tool-popup {
    position: fixed;
    display: none;
    background: var(--bg-popup);
    border: 1px solid var(--border-light);
    border-radius: 12px;
    box-shadow: var(--shadow-popup);
    z-index: 1000;
    max-height: 80vh;
    overflow-y: auto;
    font-family: var(--font-sans);
}

.tool-popup.show {
    display: block;
    animation: popupIn 0.15s ease;
}

@keyframes popupIn {
    from {
        opacity: 0;
        transform: translateX(-8px);
    }

    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.popup-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border-light);
}

.popup-title {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-primary);
}

.popup-close {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    border-radius: 4px;
    color: var(--text-tertiary);
    cursor: pointer;
}

.popup-close:hover {
    background: var(--bg-hover);
    color: var(--text-primary);
}

.popup-body {
    padding: 12px;
}

.popup-section {
    margin-bottom: 16px;
}

.popup-section:last-child {
    margin-bottom: 0;
}

.popup-section-title {
    font-size: 0.65rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--text-muted);
    margin-bottom: 8px;
    padding: 0 4px;
}

/* Bond Grid */
.bond-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 4px;
}

.bond-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 10px 6px;
    background: var(--bg-popup-section);
    border: 1px solid transparent;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.15s;
    color: var(--text-primary);
}

.bond-item:hover {
    background: var(--bg-hover);
    border-color: var(--border-medium);
}

.bond-item.active {
    background: var(--accent-blue-light);
    border-color: var(--accent-blue);
}

.bond-item svg {
    width: 32px;
    height: 24px;
}

.bond-item span {
    font-size: 0.65rem;
    color: var(--text-secondary);
    text-align: center;
}

/* Ring Grid */
.ring-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 4px;
}

.ring-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 8px 4px;
    background: var(--bg-popup-section);
    border: 1px solid transparent;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.15s;
    color: var(--text-primary);
}

.ring-item:hover {
    background: var(--bg-hover);
    border-color: var(--border-medium);
}

.ring-item.active {
    background: var(--accent-blue-light);
    border-color: var(--accent-blue);
}

.ring-item svg {
    width: 36px;
    height: 36px;
}

.ring-item span {
    font-size: 0.6rem;
    color: var(--text-secondary);
    text-align: center;
    line-height: 1.2;
}

/* Atom Grid */
.atom-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 4px;
}

.atom-item {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 10px 6px;
    background: var(--bg-popup-section);
    border: 1px solid transparent;
    border-radius: 6px;
    font-family: var(--font-mono);
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s;
    color: var(--text-primary);
}

.atom-item:hover {
    background: var(--bg-hover);
    border-color: var(--border-medium);
}

.atom-item.c {
    color: var(--atom-c);
}

.atom-item.h {
    color: var(--atom-h);
}

.atom-item.n {
    color: var(--atom-n);
}

.atom-item.o {
    color: var(--atom-o);
}

.atom-item.s {
    color: var(--atom-s);
}

.atom-item.p {
    color: var(--atom-p);
}

.atom-item.f {
    color: var(--atom-f);
}

.atom-item.cl {
    color: var(--atom-cl);
}

.atom-item.br {
    color: var(--atom-br);
}

.atom-item.i {
    color: var(--atom-i);
}

/* Functional Group Grid */
.fg-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 4px;
}

.fg-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 10px 8px;
    background: var(--bg-popup-section);
    border: 1px solid transparent;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.15s;
    color: var(--text-primary);
}

.fg-item:hover {
    background: var(--bg-hover);
    border-color: var(--border-medium);
}

.fg-item svg {
    width: 40px;
    height: 28px;
}

.fg-item span {
    font-size: 0.65rem;
    color: var(--text-secondary);
}

/* Arrow Grid */
.arrow-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 4px;
}

.arrow-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 10px 8px;
    background: var(--bg-popup-section);
    border: 1px solid transparent;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.15s;
    color: var(--text-primary);
}

.arrow-item:hover {
    background: var(--bg-hover);
    border-color: var(--border-medium);
}

.arrow-item svg {
    width: 48px;
    height: 20px;
}

.arrow-item span {
    font-size: 0.6rem;
    color: var(--text-secondary);
    text-align: center;
}

/* Charges/Radicals */
.charge-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 4px;
}

.charge-item {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 12px 8px;
    background: var(--bg-popup-section);
    border: 1px solid transparent;
    border-radius: 6px;
    font-family: var(--font-mono);
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    cursor: pointer;
    transition: all 0.15s;
}

.charge-item:hover {
    background: var(--bg-hover);
    border-color: var(--border-medium);
}

/* Overlay */
.popup-overlay {
    position: fixed;
    inset: 0;
    background: transparent;
    z-index: 999;
    display: none;
}

.popup-overlay.show {
    display: block;
}